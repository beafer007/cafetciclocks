<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <meta http-equiv="refresh" content="21600">
  <title>Clocks - Page 1 (Miami / London / Dubai)</title>

  <style>
    :root{
      --bg0:#070a0f;
      --bg1:#0a1220;
      --text: rgba(255,255,255,0.92);

      --pad: clamp(14px, 2vw, 28px);
      --radius: 26px;

      --city: clamp(22px, 2.4vw, 42px);
      --tz: clamp(16px, 1.7vw, 26px);

      /* BIGGER / BOLDER TIME */
      --time: clamp(84px, 7.4vw, 150px);
      --time24: clamp(18px, 1.9vw, 30px);

      /* BIGGER DATE */
      --date: clamp(20px, 1.9vw, 34px);
      --wx: clamp(16px, 1.55vw, 26px);
    }

    *{ box-sizing:border-box; }
    html, body{ height:100%; margin:0; }
    body{
      background:
        radial-gradient(900px 600px at 18% 10%, rgba(120,170,255,0.14), transparent 55%),
        radial-gradient(900px 600px at 85% 85%, rgba(255,120,210,0.10), transparent 55%),
        linear-gradient(160deg, var(--bg0), var(--bg1));
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      overflow:hidden;
      position:relative;
    }

    body::after{
      content:"";
      position:absolute; inset:0;
      pointer-events:none;
      background:
        radial-gradient(1200px 800px at 50% 40%, rgba(0,0,0,0.00), rgba(0,0,0,0.35)),
        repeating-linear-gradient(0deg, rgba(255,255,255,0.015), rgba(255,255,255,0.015) 1px, transparent 1px, transparent 3px);
      mix-blend-mode: overlay;
      opacity: 0.35;
    }

    .wrap{
      position:relative;
      height:100%;
      padding: var(--pad);
      display:grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: var(--pad);
      z-index: 1;
    }
    @media (max-width: 1150px){
      .wrap{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }

    .card{
      position:relative;
      border-radius: var(--radius);
      overflow:hidden;
      padding: calc(var(--pad) * 0.95);
      border: 1px solid rgba(255,255,255,0.10);
      box-shadow: 0 16px 44px rgba(0,0,0,0.46);
      backdrop-filter: blur(10px);
      background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.03));
    }

    /* Brighter vertical flag wash */
    .card::before{
      content:"";
      position:absolute; inset:0;
      background: var(--flag);
      opacity: 0.78;
      mix-blend-mode: soft-light;
      filter: saturate(1.35) contrast(1.10);
      pointer-events:none;
      z-index:0;
    }

    /* vignette for readability */
    .card::after{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(900px 600px at 50% 45%, rgba(0,0,0,0.10), rgba(0,0,0,0.60));
      pointer-events:none;
      z-index:1;
    }

    .sil{
      position:absolute;
      right: 6%;
      bottom: -2%;
      width: 112%;
      height: auto;
      opacity: 0.30;
      mix-blend-mode: soft-light;
      pointer-events:none;
      z-index:2;
      filter: blur(0.2px);
    }

    .top{
      position:relative;
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap: 12px;
      z-index:3;
    }

    .city{
      display:flex;
      align-items:center;
      gap: 10px;
      font-weight: 950;
      font-size: var(--city);
      letter-spacing: 0.2px;
      text-shadow: 0 12px 28px rgba(0,0,0,0.55);
      line-height:1.1;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      border-radius: 999px;
      padding: 8px 12px;
      background: rgba(0,0,0,0.22);
      border: 1px solid rgba(255,255,255,0.12);
      color: rgba(255,255,255,0.88);
      font-size: var(--tz);
      font-weight: 900;
      white-space: nowrap;
      text-shadow: 0 10px 22px rgba(0,0,0,0.55);
    }

    .center{
      position:relative;
      z-index:3;
      height: calc(100% - 80px);
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      text-align:center;
      gap: 12px;
    }

    .time{
      font-size: var(--time);
      font-weight: 1000; /* extra bold */
      letter-spacing: 1px;
      text-shadow: 0 26px 56px rgba(0,0,0,0.62);
      line-height:1;
    }

    .time24{
      font-size: var(--time24);
      font-weight: 950;
      letter-spacing: 3px;
      color: rgba(255,255,255,0.80);
      text-shadow: 0 14px 26px rgba(0,0,0,0.55);
      margin-top: 2px;
    }

    .date{
      font-size: var(--date);
      font-weight: 950;
      color: rgba(255,255,255,0.88);
      text-shadow: 0 16px 28px rgba(0,0,0,0.58);
    }

    .wx{
      font-size: var(--wx);
      font-weight: 900;
      color: rgba(255,255,255,0.88);
      text-shadow: 0 14px 26px rgba(0,0,0,0.55);
      line-height:1.3;
    }
    .wx small{
      display:inline-block;
      margin-left: 8px;
      font-weight: 850;
      color: rgba(255,255,255,0.76);
    }
  </style>
</head>

<body>
  <main class="wrap" id="wrap"></main>

  <script>
    // ====== CONFIG: PAGE 1 ======
    const CITIES = [
      {
        label:"Miami", tz:"America/New_York", flag:"üá∫üá∏",
        lat:25.7617, lon:-80.1918,
        flagColors:["#b22234","#ffffff","#3c3b6e"],
        silhouette:"miami"
      },
      {
        label:"London", tz:"Europe/London", flag:"üá¨üáß",
        lat:51.5072, lon:-0.1276,
        flagColors:["#012169","#ffffff","#C8102E"],
        silhouette:"london"
      },
      {
        label:"Dubai", tz:"Asia/Dubai", flag:"üá¶üá™",
        lat:25.2048, lon:55.2708,
        flagColors:["#00732f","#ffffff","#000000","#ff0000"],
        silhouette:"dubai"
      }
    ];

    const WEATHER_REFRESH_MS = 15 * 60 * 1000;

    // ====== SILHOUETTES (lightweight) ======
    const SILHOUETTES = {
      london: `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 600">
          <g fill="white">
            <rect x="0" y="520" width="1200" height="80"/>
            <rect x="820" y="180" width="90" height="340" rx="14"/>
            <rect x="808" y="150" width="114" height="40" rx="14"/>
            <rect x="835" y="110" width="60" height="50" rx="12"/>
            <polygon points="865,70 910,110 820,110"/>
            <rect x="260" y="360" width="120" height="160" rx="14"/>
            <rect x="400" y="330" width="140" height="190" rx="14"/>
            <rect x="560" y="390" width="160" height="130" rx="14"/>
          </g>
        </svg>
      `,
      dubai: `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 600">
          <g fill="white">
            <rect x="0" y="520" width="1200" height="80"/>
            <polygon points="820,520 900,520 880,180 870,120 860,80 850,120 840,180" />
            <rect x="858" y="40" width="6" height="60"/>
            <rect x="640" y="360" width="90" height="160" rx="12"/>
            <rect x="740" y="310" width="70" height="210" rx="12"/>
            <rect x="930" y="350" width="120" height="170" rx="14"/>
          </g>
        </svg>
      `,
      miami: `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 600">
          <g fill="white">
            <rect x="0" y="520" width="1200" height="80"/>
            <rect x="940" y="240" width="20" height="280" rx="10"/>
            <path d="M950 240 C880 220, 850 180, 870 150 C900 160, 930 190, 970 210 Z" />
            <path d="M950 240 C1020 220, 1050 180, 1030 150 C1000 160, 970 190, 930 210 Z" />
            <rect x="640" y="360" width="140" height="160" rx="20"/>
            <rect x="800" y="330" width="120" height="190" rx="20"/>
          </g>
        </svg>
      `
    };

    // ====== HELPERS ======
    function escapeHtml(str){
      return String(str).replace(/[&<>"']/g, s => ({
        "&":"&amp;", "<":"&lt;", ">":"&gt;", '"':"&quot;", "'":"&#039;"
      }[s]));
    }

    function svgDataUri(svg){
      const s = svg.trim().replace(/\s+/g, " ");
      return `data:image/svg+xml,${encodeURIComponent(s).replace(/'/g,"%27").replace(/"/g,"%22")}`;
    }

    function verticalFlagGradient(colors){
      const cols = Array.isArray(colors) && colors.length ? colors : ["#ffffff"];
      const n = cols.length;
      const stops = cols.map((c,i)=>{
        const p0 = Math.round((i / n) * 100);
        const p1 = Math.round(((i + 1) / n) * 100);
        return `${c} ${p0}%, ${c} ${p1}%`;
      }).join(", ");
      return `linear-gradient(90deg, ${stops})`;
    }

    function fmtTime12(tz){
      return new Intl.DateTimeFormat("en-US", {
        timeZone: tz,
        hour: "2-digit",
        minute: "2-digit",
        hour12: true
      }).format(new Date());
    }

    // 24h WITH seconds (requested)
    function fmtTime24WithSeconds(tz){
      return new Intl.DateTimeFormat("en-US", {
        timeZone: tz,
        hour: "2-digit",
        minute: "2-digit",
        second: "2-digit",
        hour12: false
      }).format(new Date());
    }

    function fmtDate(tz){
      return new Intl.DateTimeFormat("en-US", {
        timeZone: tz,
        weekday: "short",
        month: "short",
        day: "2-digit"
      }).format(new Date());
    }

    function tzShortName(tz){
      const parts = new Intl.DateTimeFormat("en-US", {
        timeZone: tz, timeZoneName:"short"
      }).formatToParts(new Date());
      return parts.find(p=>p.type==="timeZoneName")?.value || tz;
    }

    function fToC(f){
      return Math.round((f - 32) * 5 / 9);
    }

    function wxFromCode(code){
      const map = {
        0:["‚òÄÔ∏è","Clear"],
        1:["üå§Ô∏è","Mostly clear"],
        2:["‚õÖ","Partly cloudy"],
        3:["‚òÅÔ∏è","Overcast"],
        45:["üå´Ô∏è","Fog"],
        51:["üå¶Ô∏è","Drizzle"],
        61:["üåßÔ∏è","Rain"],
        71:["üå®Ô∏è","Snow"],
        80:["üå¶Ô∏è","Showers"],
        95:["‚õàÔ∏è","Thunderstorm"]
      };
      return map[code] || ["üå°Ô∏è","Weather"];
    }

    async function fetchWeather(lat, lon){
      const url =
        `https://api.open-meteo.com/v1/forecast` +
        `?latitude=${lat}` +
        `&longitude=${lon}` +
        `&current=temperature_2m,weather_code` +
        `&daily=temperature_2m_max,temperature_2m_min` +
        `&temperature_unit=fahrenheit` +
        `&timezone=auto`;

      const res = await fetch(url, { cache: "no-store" });
      if (!res.ok) throw new Error("Weather fetch failed");
      const data = await res.json();

      // tomorrow = index 1
      return {
        tempNowF: Math.round(data.current.temperature_2m),
        code: data.current.weather_code,
        tomorrowHiF: Math.round(data.daily.temperature_2m_max[1]),
        tomorrowLoF: Math.round(data.daily.temperature_2m_min[1])
      };
    }

    // ====== UI BUILD ======
    const wrap = document.getElementById("wrap");

    function build(){
      wrap.innerHTML = "";
      for (const c of CITIES){
        const card = document.createElement("section");
        card.className = "card";
        card.style.setProperty("--flag", verticalFlagGradient(c.flagColors));

        const silSvg = SILHOUETTES[c.silhouette];
        const sil = silSvg ? `<img class="sil" alt="" src="${svgDataUri(silSvg)}">` : "";

        card.innerHTML = `
          ${sil}
          <div class="top">
            <div class="city">${escapeHtml(c.flag)} ${escapeHtml(c.label)}</div>
            <div class="pill">${escapeHtml(tzShortName(c.tz))}</div>
          </div>

          <div class="center">
            <div class="time" data-time12="${escapeHtml(c.tz)}">--:--</div>
            <div class="time24" data-time24="${escapeHtml(c.tz)}">--:--:--</div>
            <div class="date" data-date="${escapeHtml(c.tz)}">---</div>
            <div class="wx" data-wx="${escapeHtml(c.label)}">Loading‚Ä¶</div>
          </div>
        `;

        card.dataset.tz = c.tz;
        card.dataset.label = c.label;
        card.dataset.lat = c.lat;
        card.dataset.lon = c.lon;
        wrap.appendChild(card);
      }
    }

    function tick(){
      document.querySelectorAll("[data-time12]").forEach(el=>{
        const tz = el.getAttribute("data-time12");
        el.textContent = fmtTime12(tz);
      });

      document.querySelectorAll("[data-time24]").forEach(el=>{
        const tz = el.getAttribute("data-time24");
        el.textContent = fmtTime24WithSeconds(tz);
      });

      document.querySelectorAll("[data-date]").forEach(el=>{
        const tz = el.getAttribute("data-date");
        el.textContent = fmtDate(tz);
      });
    }

    async function refreshWeather(){
      const cards = Array.from(document.querySelectorAll(".card"));
      const tasks = cards.map(async (card)=>{
        const label = card.dataset.label;
        const lat = Number(card.dataset.lat);
        const lon = Number(card.dataset.lon);
        const wxEl = card.querySelector(`[data-wx="${CSS.escape(label)}"]`);
        if (!wxEl) return;

        try{
          const wx = await fetchWeather(lat, lon);
          const [icon, desc] = wxFromCode(wx.code);

          const nowF = wx.tempNowF;
          const nowC = fToC(nowF);

          const hiF = wx.tomorrowHiF, loF = wx.tomorrowLoF;
          const hiC = fToC(hiF), loC = fToC(loF);

          wxEl.innerHTML =
            `${icon} ${nowF}¬∞F / ${nowC}¬∞C ${escapeHtml(desc)}` +
            `<small>‚Ä¢ Tomorrow ${hiF}¬∞/${loF}¬∞F (${hiC}¬∞/${loC}¬∞C)</small>`;
        }catch{
          wxEl.textContent = "Weather unavailable";
        }
      });

      await Promise.allSettled(tasks);
    }

    // ====== START ======
    build();
    tick();
    setInterval(tick, 1000);

    refreshWeather();
    setInterval(refreshWeather, WEATHER_REFRESH_MS);
  </script>
</body>
</html>
