<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>Clocks 2 (3-up)</title>

  <style>
    :root{
      --bg:#0a0f18;
      --glass: rgba(30, 36, 48, 0.62);
      --glass2: rgba(255,255,255,0.10);
      --text: rgba(255,255,255,0.94);
      --muted: rgba(255,255,255,0.82);
      --muted2: rgba(255,255,255,0.68);

      --cardRadius: 28px;

      /* requested */
      --citySize: 160px; /* <‚Äî city text size */
      --timeSize: clamp(120px, 8.5vw, 140px);
      --ampmSize: clamp(70px, 4.6vw, 110px);

      /* bottom block sizing (match your 2nd pic: bold, bigger, readable) */
      --meta24: clamp(28px, 2.0vw, 44px);
      --metaDate: clamp(34px, 2.4vw, 54px);
      --metaTemp: clamp(40px, 2.7vw, 62px);
      --metaDesc: clamp(30px, 2.2vw, 48px);
      --metaSub: clamp(26px, 1.9vw, 42px);
    }

    *{ box-sizing: border-box; }
    html, body{ height:100%; margin:0; }
    body{
      background: radial-gradient(1100px 700px at 20% 20%, rgba(90,140,255,0.20), transparent 60%),
                  radial-gradient(1100px 700px at 80% 80%, rgba(255,90,180,0.16), transparent 60%),
                  linear-gradient(160deg, #05070c, var(--bg));
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      overflow: hidden;
    }

    .wrap{
      height: 100%;
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 14px;
      padding: 14px;
    }

    .panel{
      position: relative;
      border-radius: var(--cardRadius);
      overflow: hidden;
      box-shadow: 0 18px 60px rgba(0,0,0,0.55);
      border: 1px solid rgba(255,255,255,0.10);
      background: #0b0f18;
    }

    /* brighter flag stripes */
    .panel::before{
      content:"";
      position:absolute; inset:0;
      background: linear-gradient(90deg, var(--c1) 0 33.333%, var(--c2) 33.333% 66.666%, var(--c3) 66.666% 100%);
      filter: saturate(1.25) contrast(1.06);
      opacity: 0.98;
      transform: translateZ(0);
    }

    /* a subtle dark veil so white stripe doesn‚Äôt nuke the text */
    .panel::after{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(900px 500px at 50% 55%, rgba(0,0,0,0.24), rgba(0,0,0,0.40));
      pointer-events:none;
    }

    .tzPill{
      position:absolute;
      top: 16px; right: 16px;
      z-index: 4;
      padding: 10px 14px;
      border-radius: 999px;
      font-weight: 900;
      letter-spacing: 0.6px;
      font-size: 18px;
      color: rgba(255,255,255,0.92);
      background: rgba(0,0,0,0.30);
      border: 1px solid rgba(255,255,255,0.14);
      backdrop-filter: blur(8px);
      text-shadow: 0 10px 26px rgba(0,0,0,0.55);
    }

    /* CENTER GLASS ‚Äî now ‚Äúend to end‚Äù inside each panel */
    .glass{
      position:absolute;
      left: 18px; right: 18px;
      top: 50%;
      transform: translateY(-50%);
      z-index: 5;
      border-radius: 22px;
      padding: 28px 34px 26px;
      background: linear-gradient(180deg, rgba(255,255,255,0.14), rgba(255,255,255,0.08));
      border: 1px solid rgba(255,255,255,0.18);
      box-shadow: 0 22px 50px rgba(0,0,0,0.45);
      backdrop-filter: blur(14px);
    }

    .cityRow{
      display:flex;
      align-items: baseline;
      justify-content: center;
      gap: 18px;
      margin-bottom: 12px;
      text-shadow: 0 14px 40px rgba(0,0,0,0.55);
      white-space: nowrap;
    }

    .cityFlag{
      font-size: calc(var(--citySize) * 0.8);
      line-height: 1;
      filter: drop-shadow(0 12px 22px rgba(0,0,0,0.45));
    }

    .cityName{
      font-weight: 950;
      letter-spacing: 0.5px;
      font-size: var(--citySize);
      line-height: 0.95;
    }

    .timeRow{
      display:flex;
      align-items: baseline;
      justify-content: center;
      gap: 14px;
      margin: 6px 0 8px;
      text-shadow: 0 18px 50px rgba(0,0,0,0.60);
      white-space: nowrap;
    }

    .timeMain{
      font-size: var(--timeSize);
      font-weight: 950;
      letter-spacing: 1px;
      line-height: 0.95;
    }

    .colon{
      display:inline-block;
      width: 0.45em;
      text-align: center;
      animation: blink 1s steps(1,end) infinite;
      opacity: 0.95;
    }
    @keyframes blink{ 50%{ opacity: 0.18; } }

    .ampm{
      font-size: var(--ampmSize);
      font-weight: 950;
      letter-spacing: 1px;
      opacity: 0.98;
      margin-left: -8px;
    }

    /* ===== Bottom block: match your 2nd pic ===== */
    .metaBlock{
      text-align: center;
      margin-top: 8px;
      color: rgba(255,255,255,0.94);
      text-shadow: 0 12px 28px rgba(0,0,0,0.55);
    }

    .meta24{
      font-size: var(--meta24);
      font-weight: 950;
      letter-spacing: 1px;
      color: rgba(255,255,255,0.92);
      margin-top: 6px;
    }

    .metaDate{
      font-size: var(--metaDate);
      font-weight: 950;
      color: rgba(255,255,255,0.95);
      margin-top: 4px;
    }

    .wxRow{
      display:flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      margin-top: 14px; /* moved down a bit */
    }

    .wxIconPill{
      width: 56px; height: 56px;
      border-radius: 14px;
      display:grid;
      place-items:center;
      background: rgba(0,0,0,0.30);
      border: 1px solid rgba(255,255,255,0.18);
      backdrop-filter: blur(8px);
      box-shadow: 0 16px 30px rgba(0,0,0,0.35);
      font-size: 30px;
    }

    .wxTemp{
      font-size: var(--metaTemp);
      font-weight: 950;
      letter-spacing: 0.6px;
      white-space: nowrap;
    }

    .wxDesc{
      margin-top: 12px;
      font-size: var(--metaDesc);
      font-weight: 950;
      color: rgba(255,255,255,0.92);
    }

    .wxTomorrow{
      margin-top: 6px;
      font-size: var(--metaSub);
      font-weight: 900;
      color: rgba(255,255,255,0.88);
    }

    /* keep it usable on smaller widths */
    @media (max-width: 1200px){
      :root{ --citySize: 72px; }
      .wrap{ grid-template-columns: 1fr; }
      .panel{ height: calc(33.333vh - 12px); }
    }
  </style>
</head>

<body>
  <div class="wrap" id="wrap"></div>

  <script>
    const WEATHER_REFRESH_MS = 15 * 60 * 1000;

    // Page 1 clocks (Miami, London, Dubai)
    const CLOCKS = [
      {
        label: "Miami",
        tz: "America/New_York",
        flag: "üá∫üá∏",
        tzShort: "EST",
        lat: 25.7617, lon: -80.1918,
        flagColors: ["#d81f2a", "#ffffff", "#1c3aa9"]
      },
      {
        label: "London",
        tz: "Europe/London",
        flag: "üá¨üáß",
        tzShort: "GMT",
        lat: 51.5072, lon: -0.1276,
        flagColors: ["#0033a0", "#ffffff", "#d81f2a"]
      },
      {
        label: "Dubai",
        tz: "Asia/Dubai",
        flag: "üá¶üá™",
        tzShort: "GMT+4",
        lat: 25.2048, lon: 55.2708,
        flagColors: ["#1f7a34", "#ffffff", "#000000"] // UAE simplified stripes vibe
      }
    ];

    const wrap = document.getElementById("wrap");

    function fToC(f){ return Math.round((f - 32) * 5 / 9); }

    function wxFromCode(code){
      const map = {
        0:["‚òÄÔ∏è","Clear"],1:["üå§Ô∏è","Mostly clear"],2:["‚õÖ","Partly cloudy"],3:["‚òÅÔ∏è","Overcast"],
        45:["üå´Ô∏è","Fog"],48:["üå´Ô∏è","Rime fog"],
        51:["üå¶Ô∏è","Drizzle"],53:["üå¶Ô∏è","Drizzle"],55:["üå¶Ô∏è","Drizzle"],
        56:["üåßÔ∏è","Freezing drizzle"],57:["üåßÔ∏è","Freezing drizzle"],
        61:["üåßÔ∏è","Rain"],63:["üåßÔ∏è","Rain"],65:["üåßÔ∏è","Heavy rain"],
        66:["üåßÔ∏è","Freezing rain"],67:["üåßÔ∏è","Freezing rain"],
        71:["üå®Ô∏è","Snow"],73:["üå®Ô∏è","Snow"],75:["üå®Ô∏è","Heavy snow"],77:["üå®Ô∏è","Snow grains"],
        80:["üå¶Ô∏è","Showers"],81:["üå¶Ô∏è","Showers"],82:["üåßÔ∏è","Heavy showers"],
        85:["üå®Ô∏è","Snow showers"],86:["üå®Ô∏è","Snow showers"],
        95:["‚õàÔ∏è","Thunderstorm"],96:["‚õàÔ∏è","Thunderstorm"],99:["‚õàÔ∏è","Thunderstorm"]
      };
      return map[code] || ["üå°Ô∏è","Weather"];
    }

    function fmtDayDateLong(tz){
      return new Intl.DateTimeFormat("en-US", {
        timeZone: tz,
        weekday: "long",
        month: "short",
        day: "2-digit"
      }).format(new Date());
    }

    function two(n){ return String(n).padStart(2,"0"); }

    function getParts(tz){
      const d = new Date();
      const parts = new Intl.DateTimeFormat("en-US", {
        timeZone: tz,
        hour: "numeric",
        minute: "2-digit",
        hour12: true
      }).formatToParts(d);

      const hour = parts.find(p=>p.type==="hour")?.value ?? "12";
      const minute = parts.find(p=>p.type==="minute")?.value ?? "00";
      const ampm = (parts.find(p=>p.type==="dayPeriod")?.value ?? "AM").toUpperCase();
      return { hour, minute, ampm };
    }

    function get24(tz){
      const d = new Date();
      const p = new Intl.DateTimeFormat("en-US", {
        timeZone: tz,
        hour: "2-digit",
        minute: "2-digit",
        hour12: false
      }).formatToParts(d);
      const hh = p.find(x=>x.type==="hour")?.value ?? "00";
      const mm = p.find(x=>x.type==="minute")?.value ?? "00";
      return `${hh}:${mm}`;
    }

    async function fetchWeatherF(lat, lon){
      // Fahrenheit from API; we convert to Celsius for display.
      const url =
        `https://api.open-meteo.com/v1/forecast` +
        `?latitude=${encodeURIComponent(lat)}` +
        `&longitude=${encodeURIComponent(lon)}` +
        `&current=temperature_2m,weather_code` +
        `&daily=temperature_2m_max,temperature_2m_min,weather_code` +
        `&temperature_unit=fahrenheit` +
        `&timezone=auto`;

      const res = await fetch(url, { cache: "no-store" });
      if (!res.ok) throw new Error("Weather fetch failed");
      const data = await res.json();

      const curF = data?.current?.temperature_2m;
      const curCode = data?.current?.weather_code;

      const tmax = data?.daily?.temperature_2m_max || [];
      const tmin = data?.daily?.temperature_2m_min || [];
      const dcode = data?.daily?.weather_code || [];

      // tomorrow = index 1 (index 0 is today)
      const tMaxF = (typeof tmax[1] === "number") ? Math.round(tmax[1]) : null;
      const tMinF = (typeof tmin[1] === "number") ? Math.round(tmin[1]) : null;
      const tomorrowCode = dcode[1];

      return {
        curF: (typeof curF === "number") ? Math.round(curF) : null,
        curCode,
        tomorrowMaxF: tMaxF,
        tomorrowMinF: tMinF,
        tomorrowCode
      };
    }

    function makePanel(c){
      const panel = document.createElement("section");
      panel.className = "panel";
      panel.style.setProperty("--c1", c.flagColors[0]);
      panel.style.setProperty("--c2", c.flagColors[1]);
      panel.style.setProperty("--c3", c.flagColors[2]);

      panel.innerHTML = `
        <div class="tzPill">${c.tzShort}</div>

        <div class="glass" data-panel="${c.tz}">
          <div class="cityRow">
            <div class="cityFlag">${c.flag}</div>
            <div class="cityName">${c.label}</div>
          </div>

          <div class="timeRow">
            <div class="timeMain">
              <span data-h="${c.tz}">--</span><span class="colon">:</span><span data-m="${c.tz}">--</span>
            </div>
            <div class="ampm" data-ap="${c.tz}">--</div>
          </div>

          <div class="metaBlock">
            <div class="meta24"><span style="opacity:.95">24HR</span> <span data-t24="${c.tz}">--:--</span></div>
            <div class="metaDate" data-date="${c.tz}">--------</div>

            <div class="wxRow">
              <div class="wxIconPill" data-wxicon="${c.tz}">üå°Ô∏è</div>
              <div class="wxTemp" data-wxtemp="${c.tz}">--¬∞F / --¬∞C</div>
            </div>

            <div class="wxDesc" data-wxdesc="${c.tz}">Loading‚Ä¶</div>
            <div class="wxTomorrow" data-wxtom="${c.tz}">Tomorrow --/--¬∞F (--/--¬∞C)</div>
          </div>
        </div>
      `;
      return panel;
    }

    function render(){
      wrap.innerHTML = "";
      for (const c of CLOCKS) wrap.appendChild(makePanel(c));
    }

    function tick(){
      for (const c of CLOCKS){
        const { hour, minute, ampm } = getParts(c.tz);
        const hEl = document.querySelector(`[data-h="${c.tz}"]`);
        const mEl = document.querySelector(`[data-m="${c.tz}"]`);
        const apEl = document.querySelector(`[data-ap="${c.tz}"]`);
        if (hEl) hEl.textContent = hour;
        if (mEl) mEl.textContent = minute;
        if (apEl) apEl.textContent = ampm;

        const t24El = document.querySelector(`[data-t24="${c.tz}"]`);
        if (t24El) t24El.textContent = get24(c.tz);

        const dEl = document.querySelector(`[data-date="${c.tz}"]`);
        if (dEl) dEl.textContent = fmtDayDateLong(c.tz);
      }
    }

    async function refreshWeather(){
      const tasks = CLOCKS.map(async (c) => {
        try{
          const wx = await fetchWeatherF(c.lat, c.lon);
          const [icon, desc] = wxFromCode(wx.curCode);

          const curF = wx.curF;
          const curC = (typeof curF === "number") ? fToC(curF) : null;

          const maxF = wx.tomorrowMaxF;
          const minF = wx.tomorrowMinF;
          const maxC = (typeof maxF === "number") ? fToC(maxF) : null;
          const minC = (typeof minF === "number") ? fToC(minF) : null;

          const iconEl = document.querySelector(`[data-wxicon="${c.tz}"]`);
          const tempEl = document.querySelector(`[data-wxtemp="${c.tz}"]`);
          const descEl = document.querySelector(`[data-wxdesc="${c.tz}"]`);
          const tomEl  = document.querySelector(`[data-wxtom="${c.tz}"]`);

          if (iconEl) iconEl.textContent = icon;
          if (tempEl) tempEl.textContent = `${curF ?? "--"}¬∞F / ${curC ?? "--"}¬∞C`;
          if (descEl) descEl.textContent = desc;

          if (tomEl){
            const fPart = `${maxF ?? "--"}/${minF ?? "--"}¬∞F`;
            const cPart = `(${maxC ?? "--"}/${minC ?? "--"}¬∞C)`;
            tomEl.textContent = `Tomorrow ${fPart} ${cPart}`;
          }
        } catch {
          const iconEl = document.querySelector(`[data-wxicon="${c.tz}"]`);
          const tempEl = document.querySelector(`[data-wxtemp="${c.tz}"]`);
          const descEl = document.querySelector(`[data-wxdesc="${c.tz}"]`);
          const tomEl  = document.querySelector(`[data-wxtom="${c.tz}"]`);

          if (iconEl) iconEl.textContent = "üå°Ô∏è";
          if (tempEl) tempEl.textContent = `--¬∞F / --¬∞C`;
          if (descEl) descEl.textContent = `Weather`;
          if (tomEl)  tomEl.textContent  = `Tomorrow --/--¬∞F (--/--¬∞C)`;
        }
      });

      await Promise.allSettled(tasks);
    }

    // Start
    render();
    tick();
    refreshWeather();

    setInterval(tick, 1000);
    setInterval(refreshWeather, WEATHER_REFRESH_MS);
  </script>
</body>
</html>
